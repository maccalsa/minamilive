# This is a MINIMAL Caddyfile for testing TLS on localhost:8443.
# It removes all other configurations to isolate the TLS issue.

{
	# Global options block.
	# Explicitly disable automatic HTTPS management for this Caddy instance.
	# This prevents Caddy from trying to bind to port 80/443 for redirects or challenges.
	auto_https off

	# Admin interface is useful for debugging, keep it.
	admin localhost:2020

    # Enable debug logging for verbose output.
	# This directive belongs in the global options block.
	debug

	# This tells Caddy to manage certificates for 'localhost' using the internal issuer.
	# tls localhost {
	# 	issuer internal
	# }
	
}

# Minimal server configuration block for localhost:8443.
# This block only listens on 8443 and serves a static response.
localhost:8443 {
	# Explicitly tell Caddy to manage TLS for this site using its internal CA.
	tls internal	

	# Respond with a simple message for all requests.
	# This bypasses all reverse proxying, headers, etc.
	respond "Caddy TLS test successful on port 8443!" 200 {
		close
	}

	# Commented out all other directives for this minimal test:
	# header { ... }
	# encode gzip zstd
	# log { ... }
	# handle_path /api/* { ... }
	# handle_path /ws/* { ... }
	# handle /* { ... }
}
